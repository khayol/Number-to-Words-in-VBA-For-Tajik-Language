@page "/IndOrg/IndividualAdd"
@inject IndividualController IndividualController
@inject GenderController GenderController
@inject GnrSrv GnrSrv 

<AuthorizeView Roles="@admSer.GetRolesList("IndividualAdd")" Context="authContext">
<Authorized>
<EditForm Model="@objIndividual" OnValidSubmit="@CreateIndividual">  
    <FluentValidationValidator />  @* <DataAnnotationsValidator />   It's Standard method of validations *@
    <ValidationSummary/>
    <WrPnlElm>
    <ControlQuickAccess>
    <input type="submit" class="btn bnt-style-general"  value="@trs.GetTranslation("Save",@AppData.ActiveUser,"General")" >
    <input type="button" class="btn bnt-style-general" @onclick="@Cancel" value="@trs.GetTranslation("Cancel",@AppData.ActiveUser,"General")">
    @* <button class="btn bnt-style-general" @onclick="@(args => NavManager.NavigateTo(AppData.IndividualLink))" data-toggle="tooltip" title="Beck"><span class="fa fa-backward" aria-hidden="true"></span> Beck</button> *@
    </ControlQuickAccess>
    </WrPnlElm>
  <WrFormBody>
        <FormElements>

            <WrFieldStr  FieldCaption="FirstName"
            TransEntity="Individual"  @bind-BindingValue ="@objIndividual.FirstName"/> 

            <WrFieldStr FieldCaption="SecondName"
            TransEntity="Individual"  @bind-BindingValue ="@objIndividual.SecondName"/>

            <WrFieldStr  FieldCaption="LastName"
            TransEntity="Individual"  @bind-BindingValue ="@objIndividual.LastName"/>

            <WrFieldStr  FieldCaption="FirstNameEN"
            TransEntity="Individual"  @bind-BindingValue ="@objIndividual.FirstNameEN"/>

            <WrFieldStr  FieldCaption="SecondNameEN"
            TransEntity="Individual"  @bind-BindingValue ="@objIndividual.SecondNameEN"/>

            <WrFieldStr FieldCaption="LastNameEN"
            TransEntity="Individual"  @bind-BindingValue ="@objIndividual.LastNameEN"/>    

          <WrFieldDateTime TransEntity="Individual" FieldCaption="BirthDay">
               <RenderFrg>
                   <InputDate  form="BirthDay"  class="form-control"  @bind-Value="@objIndividual.BirthDay" @bind-Value:format="dd/MM/yyyy"/>
               </RenderFrg>
           </WrFieldDateTime>
            
            <WrFieldStr  FieldCaption="Address"
            TransEntity="Individual"  @bind-BindingValue ="@objIndividual.Address"/>
         
            <WrFieldStr  FieldCaption="PassSerial"
            TransEntity="Individual"  @bind-BindingValue ="@objIndividual.PassSerial"/>
    
            <WrFieldStr  FieldCaption="PassCode"
            TransEntity="Individual"  @bind-BindingValue ="@objIndividual.PassCode"/>
 
            <div class="form-group">
             <WrLebel TransEntity="Individual" FieldCaption="Gender"/>
                <select class="form-control selectpicker" @bind="@objIndividual.GenderId">
                    <option>--select--</option>
                    @foreach (var item in GenderList)
                    {
                    <option value="@item.Id">@item.Name</option> // Blazor needs to know what values it binds to!
                    }
                </select>
            </div>
       
       </FormElements>      
    </WrFormBody> 
</EditForm>

</Authorized>
 <NotAuthorized>
       <WrPageNotFound/>
 </NotAuthorized>

  </AuthorizeView>


@code{

    [Parameter]
    public string CurrentID { get; set; }

    Individual objIndividual= new Individual();

     private List<Gender> GenderList;
  
       protected override void OnInitialized()
    {
        GenderList =  GenderController.GetGender();
    }

     protected  void CreateIndividual()
     { 
        IndividualController.Create(objIndividual);
        NavManager.NavigateTo("/IndOrg/IndividualViewStd/"+AppData.Individual_IdSelect);
     }

    void Cancel(){
        NavManager.NavigateTo("/IndOrg/IndividualViewStd/"+AppData.Individual_IdSelect);
    }

}