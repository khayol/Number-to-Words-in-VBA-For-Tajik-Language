@page "/IndOrg/Individual/View/{CurrentId}"
@inject IndividualController MainController
@inject GenderController GenderController
@inject CountryController CountryController
@inject GnrSrv GnrSrv 

<WrAuth PageName="IndividualEdit"><MainContent>  

<EditForm Model="@_objMain" OnValidSubmit="@Cancel" Context="formContext">  
    <FluentValidationValidator />  @* <DataAnnotationsValidator />   It's Standard method of validations *@
    <ValidationSummary/>
    
    <WrPnlElm>
        <ControlQuickAccess>
            <WrOper Category="EditForm" EditOrView=true  TypeInput="button" Txt="back"  OnClickCallback="Cancel"/> 
       </ControlQuickAccess>
    </WrPnlElm>

    <WrFormBody>
        <FormElements>
            <WrFieldInt TransEntity="Individual" FieldCaption="Code" 
            Readonly="true" Val="@_objMain.Code" />

           <WrFieldStr Readonly="true" FieldCaption="FirstName"
            TransEntity="Individual"  @bind-BindingValue ="@_objMain.FirstName"/> 

            <WrFieldStr Readonly="true" FieldCaption="SecondName"
            TransEntity="Individual"  @bind-BindingValue ="@_objMain.SecondName"/>

            <WrFieldStr Readonly="true" FieldCaption="LastName"
            TransEntity="Individual"  @bind-BindingValue ="@_objMain.LastName"/>

            <WrFieldStr Readonly="true" FieldCaption="FirstNameEN"
            TransEntity="Individual"  @bind-BindingValue ="@_objMain.FirstNameEN"/>

            <WrFieldStr Readonly="true" FieldCaption="SecondNameEN"
            TransEntity="Individual"  @bind-BindingValue ="@_objMain.SecondNameEN"/>

            <WrFieldStr Readonly="true" FieldCaption="LastNameEN"
            TransEntity="Individual"  @bind-BindingValue ="@_objMain.LastNameEN"/>    
           
           <WrFieldDateTime TransEntity="Individual" FieldCaption="BirthDay">
               <RenderFrg>
                   <InputDate readonly="@true"  form="BirthDay"  class="form-control"  @bind-Value="@_objMain.BirthDay" @bind-Value:format="dd/MM/yyyy"/>
               </RenderFrg>
           </WrFieldDateTime>
            
            <WrFieldStr Readonly="true" FieldCaption="Address"
            TransEntity="Individual"  @bind-BindingValue ="@_objMain.Address"/>

            <WrFieldArray TransEntity="Individual" FieldCaption="Contact" >
                <RenderFrg>
                <label  class="control-clct">@GnrSrv.ExistDataORNotFlag("Contact", "IndividualId", @CurrentId)</label>
                </RenderFrg>
            </WrFieldArray>

            <WrFieldStr Readonly="true" FieldCaption="PassSerial"
            TransEntity="Individual"  @bind-BindingValue ="@_objMain.PassSerial"/>
    
            <WrFieldStr Readonly="true" FieldCaption="PassCode"
            TransEntity="Individual"  @bind-BindingValue ="@_objMain.PassCode"/>
 
            <div class="form-group">
                     <WrLebel TransEntity="Individual" FieldCaption="Gender"/>
                          <select disabled="@true" class="form-control selectpicker" @bind="@_objMain.GenderId">
                            <option>--select--</option>
                            @foreach (var item in _genderList)
                            {
                            <option value="@item.Id">@item.Name</option> // Blazor needs to know what values it binds to!
                            }
                        </select>   
            </div> 
                 
               <div class="form-group">
                    <WrLebel TransEntity="Individual" FieldCaption="BirthPlace" />
                    <input readonly="true" form="BirthPlace" class="form-control" value="@GnrSrv.GetReleatedData("Country", "Name", @_objMain.BirthPlace_CountryId.ToString())" />
                </div>
     
                <div class="form-group">
                    <WrLebel TransEntity="Individual" FieldCaption="CreatedDate"/>
                    <input  readonly="true" class="form-control" @bind="@_objMain.CreatedDate" />
                </div>

        </FormElements>      
    </WrFormBody>    
    </EditForm>    
</MainContent></WrAuth>


@code{ 
    [Parameter] public string CurrentId { get; set; }
    Individual _objMain = new Individual();    
    private List<Country> _countryList;    
    private List<Gender> _genderList;

    protected override void OnInitialized()
    {
        _objMain = MainController.GetById_FirstOrDefault(Convert.ToInt32(CurrentId));
        _genderList =  GenderController.Get();
        _countryList =  CountryController.Get();
    }
    void Cancel()
    {
         NavManager.NavigateTo("/IndOrg/Individual/ViewStd/"+CurrentId);
    }

  
}