@page "/IndOrg/Country/ViewStd/{Id}"
@inject CountryController MainController

<WrAuth PageName="CountryViewStd"><MainContent> 
    <WrDataGrid @ref="_grid"
                  DataItems="_list"
                  SelectedRow="SelectedRowMeth"
                  Columns="@MainController.columns"
                  UniqIdOfRecord="Id"
                  ColumnsToExcludeCSV="Id"
                  PageNameTitle="CountryViewStd::Dir"
                  BackLink="WndBack"
                  RowSelectFlg="true"
                  Paging="@(new PagingConfig
                            {
                                Enabled = true,
                                CustomPager = false,
                                PageSize = @AppData.rowNumMid
                            })">
         
        <ControlQuickAccess>
            <WrSrchDGrid OnSearchTextChanged="SearchTxt"> </WrSrchDGrid>
            <WrSpace Length=2/>
            <WrOper Category="RunCmd" Design="btn" Ico="fa fa-angle-double-down" OnClickCallback="@CleanSearchBox"  TxtToolTip="ShowMoreRecords" />
            <WrOper Category="RunCmd" Design="btn" Ico="fa fa-hand-pointer-o" OnClickCallback="@FindSelectedRec" TxtToolTip="Choose"/>
              <WrSpace Length=2/>
        </ControlQuickAccess>
    </WrDataGrid>
 </MainContent></WrAuth>


@code  {


 #region     Declare
    [Parameter] public string Id { get; set; }
    private WrDataGrid<Country> _grid;
    private List<Country> _list;
    private string SearchValue   { get; set; }  
    [Parameter] public string SelectedId { get; set;}="0";
 
 #endregion  Declare

 #region    BlazorMethods

    protected override void OnInitialized()
    {
        MainController.Initialized();
        _list = MainController.GetById(int.Parse(Id)).ToList();         
    }

#endregion BlazorMethods

#region    Event


    private void SearchTxt(ChangeEventArgs changeEventArgs)
    {
        SearchValue = changeEventArgs.Value.ToString();
        _list = MainController.GetSearchByField(SearchValue);
        _grid.GoToFirstPage();
    }
    private void SelectedRowMeth(string pSelectedRow)
    {
        SelectedId = pSelectedRow;
    }
    private void FindSelectedRec()
    {
        _grid.GoToFirstPage();
        _list = MainController.GetById(int.Parse(SelectedId));
    }
    private void CleanSearchBox()
    {
        _grid.GoToFirstPage();
        _list = MainController.GetSearchByField("");
        SelectedId = "0";
        SearchValue="";
    }

    protected void ExportToExcel()
    {
       // MainController.GenerateExcel(JSRuntime);
    }
    protected void FilterData()
    {
        JSRuntime.InvokeVoidAsync("msgbox", "FilterData");
    }
 #endregion Event

}
