@page "/Adm/ApplicationUser/Edit/{CurrentId}"
@inject ApplicationUserController MainController


<WrAuth PageName="ApplicationUserEdit"><MainContent>  

<EditForm Model="@_objMain" OnValidSubmit="@Save" OnInvalidSubmit="@Cancel" Context="formContext">  
    <FluentValidationValidator />  
    <ValidationSummary/>
    
    <WrPnlElm>
        <ControlQuickAccess>
            <WrOper Category="EditForm" EditOrView=true TypeInput="button" Txt="Cancel"  OnClickCallback="Cancel"/> 
            <WrOper Category="EditForm" EditOrView=true  TypeInput="submit" Txt="Save"/>
       </ControlQuickAccess>
    </WrPnlElm>

    <WrFormBody>
        <FormElements>
            <WrFieldInt TransEntity="General" FieldCaption="Code" 
            Readonly="true" Val="@_objMain.Code" />

            <WrFieldStr  FieldCaption="UserName" 
            TransEntity="General"  @bind-BindingValue ="@_objMain.UserName"/> 

            <WrFieldStr FieldCaption="FirstName" 
            TransEntity="Individual"  @bind-BindingValue ="@_objMain.FirstName"/>

            <WrFieldStr  FieldCaption="SecondName" 
            TransEntity="Individual"  @bind-BindingValue ="@_objMain.SecondName"/>

            <WrFieldStr  FieldCaption="LastName" 
            TransEntity="Individual"  @bind-BindingValue ="@_objMain.LastName"/>

        </FormElements>      
    </WrFormBody>    
    </EditForm>    
</MainContent></WrAuth>


@code{
    [Parameter] public string CurrentId { get; set; }
    ApplicationUser _objMain = new ApplicationUser();    

    protected override void OnInitialized()
    {
        _objMain = MainController.GetById_FirstOrDefault(CurrentId);
    }

    private void Save()
    {
        MainController.Update(_objMain);
        NavManager.NavigateTo("/Adm/ApplicationUser/ViewStd/"+CurrentId);
    }
    void Cancel()
    {
        NavManager.NavigateTo("/Adm/ApplicationUser/ViewStd/"+CurrentId);
    }

  
}